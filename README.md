# 载玻片装载器

## 执行机构部分

- 电机选型：N20电机带编码器
- 驱动芯片：TB6612(12V)

### 硬件连接

| 单片机(IO) | 驱动    | 电机  |
|---------|-------|-----|
| CW(7)   | AIN1  |     |
| CCW(8)  | AIN2  |     |
| PWM(9)  | PWMA  |     |
| 5V      | STBY  | VCC |
| GND     | GND   | GND |
|         | AOUT1 | M1  |
|         | AOUT2 | M2  |
| EA(2)   |       | C1  |
| EB(3)   |       | C2  |

### 软件逻辑

- 硬件中断读取编码器值
- 普通IO口控制电机方向
- 输出PWM控制电机速度
- 位置环PID控制，限位开关复位

## 传送机构部分

### NiMotion电机

- CANopen通信协议：

| COB-ID                 | 0   | 1  | 2-3 | 4-7 |
|------------------------|-----|----|-----|-----|
| 发送 600+ID<br/>接收580+ID | 命令符 | 索引 | 子索引 | 数据  |

- 命令符：

读取请求：0x40；写入应答：0x60；警告：0x80

| 命令符 | 8Bit | 16Bit | 24Bit | 32Bit |
|-----|------|-------|-------|-------|
| 写入  | 0x2F | 0x2B  | 0x27  | 0x23  |
| 读取  | 0x4F | 0x4B  | 0x47  | 0x43  |

- 索引、子索引详见电机通信协议书

### 硬件连接

| 单片机(IO)    | CAN收发器 | 电机   |
|------------|--------|------|
| CANRX0(13) | CRX    |      |
| CANTX0(10) | CTX    |      |
| 3.3V       | 3.3V   |      |
| GND        | GND    |      |
|            | CANH   | CANH |
|            | CANL   | CANL |

